#set($title="分享视频")

<script src="$base/dist/js/app/post.js"></script>

<div class="col-xs-12 col-md-12">
    <div class="panel panel-default">
    	<div class="panel-heading">
    		<i class="fa fa-toggle-right"></i> 发视频
    	</div>
    	<div class="panel-body">
    		<div id="message"></div>
    		<form class="form-horizontal" action="$base/post/submit/video" method="post" enctype="multipart/form-data">
    			<input type="hidden" name="type" value="${type}"/>
    			<div class="form-group">
    				<label class="col-sm-2 control-label no-padding-right">视频地址</label>
    				<div class="col-sm-8">
    					<input type="text" class="form-control" name="url" placeholder="目前仅支持优酷视频地址" data-required>
    				</div>
    			</div>
    			<div class="form-group" id="preview" style="display:none;">
    				<label for="desc" class="col-sm-2 control-label no-padding-right"></label>
                    <div class="col-sm-8">
						<div id="youkuplayer" style="width:480px;height:400px;margin-left:auto;margin-right:auto;"></div>
                    </div>
    			</div>
				<div class="form-group">
    				<label for="desc" class="col-sm-2 control-label no-padding-right">内容:</label>
    				<input type="hidden" name="editor" value="$!{setting_editor}"/>
                    <div class="col-sm-8">
						#parse("/default/post/editor/$!{setting_editor}.vm")
                    </div>
    			</div>
				<div class="form-group">
                    <label for="desc" class="col-sm-2 control-label no-padding-right">标签:</label>

                    <div class="col-sm-8">
                        <input type="hidden" name="tags" id="fieldTags">
                        <ul id="tags"></ul>
                        <p class="help-block" style="font-size: 12px;">添加相关标签，用逗号或空格分隔.</p>
                    </div>
                </div>
    			<div class="row">
    				<div class="form-group">
            			<div class="text-center">
            				<button type="submit" class="btn btn-primary">提交</button>
            			</div>
            		</div>
    			</div>
            </form>
    		<!-- /form-actions -->
        </div>
    </div>
</div>
<script type="text/javascript" src="http://player.youku.com/jsapi"></script>
<script type="text/javascript">
var player;

function youkuPlayer(vid) {
	player = new YKU.Player('youkuplayer',{
		styleid: '0',
        client_id: '7c068d0cb01cb88c',
        vid: vid
	});
}

$(function () {
	var postView = new PostView($('#uedtior'), {});
	
	$('input[name=url]').change(function () {
		var url = $(this).val();
		
		jQuery.getJSON('$base/video/take.json', {url: url}, function (ret) {
			if (ret.code >= 0 ) {
				$('#preview').show();
				youkuPlayer(ret.data.id);
				setContent(ret.data.description);
			} else {
				layer.msg(ret.message, {icon: 2});
			}
		});
	});	
});
</script>